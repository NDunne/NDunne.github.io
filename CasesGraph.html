<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        //Load google things
		google.charts.load('current', {'packages':['corechart', 'controls']});
		
		//once loaded call drawChar
		google.charts.setOnLoadCallback(drawChart);
	  
		//global CaseInfo object
		var CaseInfo = new Object();
		
		//powershell variable replaced by values
		CaseInfo['00000'] = ['Health Trails Tool','<b>W5:</b> Creating a C++/.NET tool to view and query JSON objects created by SophosHealth in a GUI.<br><br><b>W6:</b>  Functional now, but more to do<br>~ Groups Health Events by various categories<br>~ Sorts<br>~ View data<br><br><b>W7:</b> Added setup batch file to install C++ redistributale, and create reg keys to allow context right-click launch for sdu root and Trails folder.<br>Also updated UI to show a table of a child events when parent is clicked. More css is required tho!','Unresolved']
CaseInfo['00001'] = ['Case Grapher','<b>W32:</b> Working on powershell/javascript to parse case notes into progress graph using google charts api. Clicking on graph shows case history, and now all cases below the point clicked (this is not in the api as far as I can see). Powershell is used to take html notes files and compress cases into objects, then tabulate in javascript and draw with google charts. Output is a single html file that is easily trans<br><br><b>W33:</b> Working in Javascript to allow filtering of the graph using DataView class from Google charts API. Also commited to github for easier working.<br>','Unresolved']
CaseInfo['12724'] = ['Detection of &#39;both&#39; location takes 5 minutes','<b>W21:</b> Logs suggest system is waiting for a lot of DNS queries to time out, as each adapter has multiple ip addresses, and each one is retried 3 times, taking 12 seconds each time. In code found a reg key to alter retry number, requested cx change to 1 to lower delay? ','Unresolved']
CaseInfo['13785'] = ['Only one confirmation dialogue with attaching files to email for ~3s','<b>W4:</b> Initially believed to be caching action and retrieving incorrect cached action, dug through *lots* of data control code to determine key. Issue appears to actually be with repeat acknowledgement suppressor, meant to be for the same action and file in a short time. Equality operator of Acknowledgement objects reference attribute SourceFilename not set in DataControlRequest objects where Check Type is File Open (which attaching to email does). <br><br>Confirmed behaviour is the same with other File Open actions. Confirmed lack of string in local values by breaking in with debugger, comparing FileOpen locals to FileCopy (which displays all acknowledgement dialogues). FileOpen has blank strings where FileCopy has the full file path. Suggested a 1 line fix based on similar operation in the caching logic. <br>Potential Workaround of setting old Ack. timeouts to 0 not configurable :/','Suggested Fix']
CaseInfo['13854'] = ['Wifi adapter device instance ID script','<b>W1:</b> Wrote powershell script to help Emile with this case. Retrieves instance ID from active Wifi adapter device. <br>','Transferred']
CaseInfo['14171'] = ['SSPService crashing infrequently','<b>W4:</b> Logging generally unhelpful, dumps give stack trace. Code analysis allows crashing code to be exercised, does not crash every time, possible deadlock with spinlock timeout? <br><br><b>W5:</b> Update: Primary cause of crashes (for which dumps were provided) turns out to be duplicate. Recommended workaround from other ticket, investigation continues for non-duplicate crashes','Known Bug']
CaseInfo['14202'] = ['Multiple Emails from single Virus detections','<b>W4:</b> (OPM) - Confirmed with original dev that multiple log detections is sometimes expected as shell extensions can open file on double click, and Windows indexer etc. Noted events are written as JSON to a folder for SMTPConsumer to send out, dug into smtp consumer. Noted events are batched until queue is idle, 25 events are batched or user attached to batch changes. Shell extensions where accessing file as both current User &amp; System, and switch resulted in email sent, so worst case new email for every shell extension (if alternating). Confirmed behaviour by accessing file (via &gt;runas) with dummy user after double click but before cleanup and observing seperate email.<br>Suggested System user not trigger new batch, as System events can be generated by a user action. ','New Bug']
CaseInfo['14566'] = ['Spreadsheets flagged as &quot;Script/Markup&quot;','<b>W2:</b> Data Control policy flags .xlsx files as &quot;Script/Markup&quot; type. Issue believed to be browser specific so assigned to WINEP, however proved that issue only occurs on IE download as IE is the only one to perform a Data Control scan on download, other browsers do not perform file open action. <br>Uploading .xlsx files to all browsers but Edge (not supported) resulted in a flag, due to XML content of extracted archive. ','Expected']
CaseInfo['14780'] = ['Edge failing to access intranet sites','<b>W1:</b> With Sophos Web Intelligence Filter (swi_fc) running Edge cannot connect to intranet sites. Reg key allows access, not created with swi_fc. Added url to Intranet zone to work around, and raised ticket with Microsoft inquiring about new behaviour. ','Transferred']
CaseInfo['14813'] = ['Timed Web Controls not taking effect','<b>W1:</b> Schedule on web controls reverting to base policy, but only when multiple schedules exist. One schedule results expected behaviour. Discovered bug in control LUA, unavoidable return on first FOR Loop iteration, corrected to only return on TRUE. LUA change released: 2018.31<br><br>function Policy:matchTimeRange(request, schedules)<br>     trace(&#39;matchTimeRange()&#39;)<br>     ??? Sunday 1, Monday 2 ...<br>     local wday = tostring(request.wday)<br>     for _, s in ipairs(schedules) do<br>         if s[wday] then<br>             trace (&#39; - Policy day matches current day [&#39;.. wday ..&#39;]&#39;)<br>             return IsBetweenTimes (request.time, s.from, s.to)<br>         else<br>             trace (&#39; - Policy day does not match current day [&#39;.. wday ..&#39;]&#39;)<br>             return false<br>         end<br>     end<br>     return false<br> end<br>Should be:<br><br>function Policy:matchTimeRange(request, schedules)<br>    trace(&#39;matchTimeRange()&#39;)<br>    -- Sunday 1, Monday 2 ...<br>    local wday = tostring(request.wday)<br>    for _, s in ipairs(schedules) do<br>        if s[wday] then<br>            trace (&#39; - Policy day matches current day [&#39;.. wday ..&#39;]&#39;)<br>            if IsBetweenTimes(request.time, s.from, s.to) then<br>                return true<br>            end<br>        else<br>            trace (&#39; - Policy day does not match current day [&#39;.. wday ..&#39;]&#39;)<br>            return false<br>        end<br>    end<br>    return false<br>end<br><br> To prevent immediate false return if first schedule found in the list does not match current time. ','Suggested Fix']
CaseInfo['14870'] = ['Build times increased','<b>W1:</b> Control Flow Guard enabled processes taking longer with Sophos Endpoint Defence running - reproduced through small script to call 1000 enabled and not enabled processes. Attributed to slow memory region enumeration. ','Known Bug']
CaseInfo['14952'] = ['IE hanging on some downloads','<b>W2:</b> Related to previous, found some data loss prevention rules caused a hang in IE when a DLP scan was performed. Tool analysis with ConanCli.exe showed text extraction of some files was very slow and resulted in massive output file, leading to subsequent slow Regex checks. Raised CPISSUE ticket on slow SAVI text extraction and found workaround for cx.','Unresolved']
CaseInfo['14996'] = ['Lack of USB Block Notifications','<b>W3:</b> When USB devices are blocked, a notification of why the device is not working is only given the first time. Used call stack of registry calls from sdcservice to identify cpp function responsible for the check when a notification is given. Identified build version with Credential Checker and Ballista (warehouse manager), and attached Visual Studio to process to add breakpoints and break on 2 potential functions. Call path of function revealed difference between when a new device is converted from unblocked to blocked and inserting a previously blocked device. File history on Perforce showed dev who implemented change, discussed and resolved as initially intentional behaviour. MRB decided to implement cx expected functionality by alerting the user (max 1 per minute) but alert to central. ','Feature Request']
CaseInfo['15037'] = ['SAV install failing on Custom action','<b>W2:</b> SAV install custom action referenced Reg key that was never created, as installer deemed that it already existed from presence of files from previous version. Created .msi with Wix to show total reg keys was related to size of registry table, and compare successful logs to failed ones from cx. Sophos Auto Updater removed by new installer, so couldn&#39;t update previous version. Solution: find cached .msi from upgrade attempt and re-run with force overwrite flags to ensure old files are not ignored (untested).<br><br><b>W3:</b> Update: Cached .msi files did not exist, but deleting stale registry keys resolved error. ','Environment Issue']
CaseInfo['15302'] = ['2 USB sticks not blocked by DevC','<b>W7:</b> Device Control USB blanket ignoring certain device. explicit exemption also ignores them. Initially believed to be policy issue as explicit exceptions not appearing in machine.xml, however this is expected. Verbose sdcservice logs required as it appears the monitoring thread always fails to stop because it is not running when the service is stopped. No indication of why the service is stopped, or when the thread stops as the service reports starting correctly.<br><br><b>W8:</b> UPDATE: new logs provided, EnableDisable does start and run correctly, occasionally stopped by unidentified new thread (No PML), but ApplyConfig is no-where to be seen.<br><br><b>W11:</b> Storage control is reported as &quot;not requried&quot; when starting, meaning no devicetypes in the config list of type &quot;storage&quot; are marked as &quot;Blocked&quot; or &quot;ReadOnly&quot;. Need to revisit strange AlertOnly policy behaviour. In Machine xml the DisabledDeviceListManager shows devices of other types under &quot;alertOnly devices&quot;, &quot;DisabledDevices&quot; is empty. No reference to any storage devices. Interestingly in cx logs &quot;Removable Device&quot; is in Japanese while others are not.<br>Returned to initial SDU to check MCS logs. Policy arrives appearing correct, however some exclusions do not have an &quot;access&quot; attribute. Experimentation shows that this causes a policy to be processed without error, but not pushed to DEVCAdapter or machine.xml. Generated a policy XML from theirs without erroneous lines, and asked cx to drop into Persist folder to apply. Should allow USB devices to be blocked at least. Need to talk to Central on why the policy is coming down wrong.<br><br><b>W13:</b> confirmed details for Japanese office, waiting on reply <br><br><b>W14:</b> recreating policy resolved issue. Opened CESG-4688 to investigate exclusions arriving without access level in policy. ','Environment Issue']
CaseInfo['15413'] = ['Winsock catalog unexpected update','<b>W8:</b> Other applications failing to reconnect automatically on sleep exit, identified as conflict with Stormshield, where Windows sockets are re assigned by swi on start, and change is not pushed back to the winsock catalog.  Logs show when SLP checks itself (on start and every hour) it initally fails to bind a socket (access Denied), causing a re-install - leading to re-allocation of Winsock catalogue on startup. Access Denied is not inherent as the process is able to re validate after re-install. <br><br><b>W11:</b> Stormshield devs reported issue is no longer occurring with latest update after receiving knowledge of the cause of the issue. Confirmed to the cx that the issue is still possible, but very unlikely and only on Windows 7. ','Environment Issue']
CaseInfo['15452'] = ['Winsock catalog unexpected update','<b>W6:</b> Slow save to NAS. Setting up trial version to reproduce. Unable to succesfully create test cluster, ProcMon analysis shows several other processes, including some Symantec, running during save delay. <br><br><b>W7:</b> Priority raised. Another ticket came up for delay in FileScanner related to Symantec PGP desktop encryption, potentially related? Each PML shows certain instructions hanging for up to 30s, but not consistent which one. Some are Excel operations with no Sophos in the stack! Researched OpLocks, recommended cx disable them to see if there is any improvement.<br><br><b>W11:</b> seen by Emile, confirmed as bug with lease oplocks by Dell KBA, cx refusing to contact Dell despite this being recommended action. ','Environment Issue']
CaseInfo['15532'] = ['productState possible values','<b>W6:</b> Research possible values for &quot;productState&quot; from <br><br>&#39;Get-WmiObject -Namespace root\securitycenter2 -class antivirusproduct&#39;<br><br>Very undocumented! Found to be a combination of Windows constants, passed to product management to decide if the information should be made public to cx<br><br><b>W11:</b> powershell script reports status of components. Modify to apply only to Sophos?<br><br><b>W12:</b> Case revisited, confirmed previous findings and generated powershell to break down value. First byte remains a mystery. Sophos Enum sets values 0,1 and WMI enum sets 4,8 but result is always 5. unable to disable AV/AS separately so difficult to determine root. Modified Powershell to show compenents and also breakdown value of productState. ','Expected']
CaseInfo['15616'] = ['Live Protection stopping fax service','<b>W14:</b> New logs/PML/Wireshark. Cx claims Live Protection is causing issue, however wireshark shows no DNS queries (SW: SXL). Nothing clear in ProcMon or logs to indicate a failure. License key obtained from VIA-FAX vendors, but unable to replicate. Requested logging from Fax service.<br><br><b>W15:</b> issue is reproducible by enabling Malicious Traffic Detection and enabling Connection Tracking. Newest logs and PML match inital PML, with parent process stopping after 1 minute. VSI-FAX logs support this showing all child processes failing to start, therefore the parent stops itself, however the children do start in a procmon. Discovered inter-process communication through UDP-DCERPC protocol in working PML, which seems to be each process reporting itself as started to the parent. These packets are never received by the parent (blocked by MTD as related to privilege escalation exploit?), so it stops itself and leaves the 4 child processes running but not doing anything. One of these is still bound to 192.168.0.1, causing the next time the service starts to stop immediately as unable to bind to the port. This is what the second WireShark and PML were of.<br><br><b>W16:</b> Confirmed a change in MTD driver 1.7 to ignore loopback traffic alleviates the issue. New info is that MTD always drops an intercepted packet, and re-injects a copy if it is allowed, so potentially this copy is not sufficient for the parent process to accept, as the event is not returned to central as a block/drop. ','New Bug']
CaseInfo['15728'] = ['Unexpected DatC alert from NTFS FileStream','<b>W12:</b> Cx provided significant reproduction detail for 7 cases. Case 1 is simplest repros easily. Many other cases relate to policy not applying between users, e.g. log in test, lock, log in with un-managed account and DLP still applies, or using runas to execute as another user. This relates to policy, only one set of policy is stored locally, so new user policy must be pulled down before coming into effect. Potentially an issue with MCSAgent receiving 503 instead of new policy for upwards of 20 minutes after switching user account a lot though.<br>$Quota:$Q filestream is blocked as cx explained. In logs $Q for non removable drives is marked Not a File so no DatC check, unless exclusion &quot;*\$Extend\$Quota*&quot; applied, when it *is* scanned and allowed. The filestream itself is not significant, as creation of a dummy filestream (set-content -Path E:\dummy.csv -Stream dummyStream) is similarly blocked on creation. Same process for file on fixed disk reports &quot;zero length file&quot;.<br><br><b>W13:</b> Found a global exclusion that works, but the same exclusion doesn&#39;t seem to help as just on the DLP policy rule. Emailed Ian Fry for assistance.<br><br><b>W14:</b> potentially found a modification to factory.xml that excludes from data control only. Perhaps a permanent addition? Modification returned to cx to test. DatC check is DestinationOnly so only Process Exclusions apply.<br><br><b>W15:</b> Cx has confirmed that the InterCheck Exclusion in factory.xml worked as expected, so passed the change to MRB for review. NB: factory.xml was from an old sdu, so needed to be updated by cx as it broke device control. ','Suggested Fix']
CaseInfo['16251'] = ['Slow first boot non-persistent VDIs','<b>W29:</b> Older case, ETL trace casts doubt on initial analysis as it seems unlikely that Real Time Internet almost solves the problem when disabled, and also MTD. Timings are definitely not fixed like a set timeout.','Unresolved']
CaseInfo['16337'] = ['Slow xls file folder copy to server','<b>W17:</b> initially had lots of logging, but too many variables. Narrowed to disabling On-Access on the client as the cause of the slowdown, noticable by enabling and disabling mid copy. Collected etl trace.<br><br><b>W31:</b> Issue resolved for customer without further input. ','Environment Issue']
CaseInfo['16385'] = ['PUA not restored with Dell Encryption','<b>W15:</b> Cx provided software but it requires a management console. Logs show Checkhash() is failing so requested SSP BPALOGGING, and also &#39;failed to restore threat_id&#39; which is reproducible by deleting/encrypting a .dat file in SafeStore folder. Tried EAP SNTP driver, no change.<br><br><b>W16:</b> Cx provided safestore folder for attempted repro of restore. Actually used SQL to query which process had threats marked restore_failed and which blobs these belonged to<br><br>select name, size, type from BlobPropertyTable natural join BlobTable where objectid in (select objectid from ThreatObjectTable where status = &#39;restore_failed&#39;) group by name, size;<br><br>select value from StringPropertyTable where type = &#39;name&#39; and objectid in (select objectid from ThreatObjectTable where status = &#39;restore_failed&#39;) group by value<br>:pskill64 - process failing to restore<br><br>select value from StringPropertyTable where type=&#39;name&#39; and objectid in (select objectid from BlobPropertyTable where blobid in (select blobid from BlobPropertyTable where objectid in (select objectid from ThreatObjectTable where status = &#39;restore_failed&#39;)) group by objectid) group by value;<br>: pskill64.exe - process with data sharing a blob with one failing to restore. phew<br><br>select threatguid, objectguid, ThreatObjectTable.objectid, value from ThreatObjectTable inner join StringPropertyTable on ThreatObjectTable.objectid = StringPropertyTable.objectid where StringPropertyTable.type = &#39;name&#39; order by threatguid<br>:cross reference with logs <br><br><b>W17:</b> Error message suggests file contents has changed. Emailed Stephen Wassell for advice.<br><br><b>W19:</b> ssr64 tool is able to restore all files tested except pskill64.exe which has a CSC redirect path as the location. not sure why this causes all to not be restored','Unresolved']
CaseInfo['16477'] = ['Japanese Server 2012 installer text garbled','<b>W17:</b> Debugged to find font load, as copying resource files to desired location works around issue. Windows API comes back ok, but it seems an object constructor isn&#39;t assigning a value correctly. Debug build is required to debug properly as compiler optimisations mess with local values. Eventually decided that this case was not worth the time investment.','Unresolved']
CaseInfo['16527'] = ['Japanese new Error Message','<b>W16:</b> Upgrade from 10.8.1 to .2 caused new (benign) SAVI error message in logs. Looked through SAVI changelists and found nothing of note, and was also unable to replicate. Requested PML/verbose SAV log. <br><br><b>W17:</b> ThreatDetectionEngine.cpp line 880 loops through a set of processers having them check the file. On my machine SED complains that the file is Pending Delete, so the loop breaks and never reaches the VirusEngineAdapter&#39;s CheckThis() function. On the Cx&#39;s machine, SED reports &quot;not interested&quot; in the file, as they have non-Sync enabled, which allows repro of the issue. From comparing logs, on 10.8.1 the loop breaks on a scan PreProcessor because of the access denied, only logs at debug and skips the VirusEngine. From 10.8.2 a change allowed the loop to continue from this condition, meaning the VirusEngine does scan the file, and logs the access denied at Critical Level which the cxis seeing. CL: 2773892 ','Expected']
CaseInfo['16554'] = ['Clean High Disk IO','<b>W16:</b> Cx had high disk I/O from clean on reboot. Unlinked ticket same customer showed they had a significant number of HMPA detections happening very frequently, each one queuing a system scan. Clean does allow 5s for more files to arrive, but if a scan is queued during one in progress it begins immediately straight after. Scans on 100GB of data are disk intensive surprisingly. ','Expected']
CaseInfo['16598'] = ['MTD causes VOIP to drop calls','<b>W17:</b> Initial PML analysis suggested root cause may be the same as 15616, as lots of UDP sends without receives. Requested cxdisabled connection tracking, which did alleviate the issue, however the UDP traffic appears to be the same after. Requested more data.<br><br><b>W19:</b> Suggested for cx to try MTD v1.7 on the server as it shouldn&#39;t conflict wih 1.5 service. Packets are changing order causing the server to cancel calls. More loopback traffic observed on working PML, therefore hoping for loopback exclusion to fix.<br><br><b>W20:</b> 1.7 Driver resolved the issue, however it is not officially released for Server yet. Recommended cx revert to a policy without MTD until March release. Cx also requested clarification on which exclusions they could remove. ','Known Bug']
CaseInfo['16624'] = ['2GB+ upload fails on sendthisfile.com','<b>W18:</b> Initial repro - Chrome, Firefox, Edge all failed at ~28% with Sophos, all succeeded without. Found old case with change to add filter buffer limit and prevent timeout which resolves when enabled, so passed on to cx. Repro does seem to involve captcha though which only applies to free/trial accounts - cx is paid.<br><br><b>W28:</b> Remote Access: showed issue, excluded ips of file servers, installed wireshark and enabled logging (restart services) and it works. Uninstalled wireshark (rebooted), disabled logging (restart services) still works. Different UI (that I see) on other machine also still works. Seems to be related to 32bit process memory limit of 2GB. Observed the UI reach 100% once the whole file is loaded into memory by swi_fc, then memory usage begins to decline. Once it hits 0 the file is sent. Cancelling the send also does not immediately clear swi_fc&#39;s memory, it persists for a while, then begins to drop at a steady rate. This means that after cancelling a request that was routed through swi_fc even a smaller request could cause the issue by pushing usage over 2gb. It seems that Windows 1809 allows IP exclusions to not be routed through swi_fc, so the cx can try upgrading, combined with IP exclusions for all the fileservers, to get around the issue. The only reason this is an issue is because send this file uploads with a single post request, rather than breaking the file down, so the whole file must be loaded into memory by swi_fc before it can be sent. ','Environment Issue']
CaseInfo['16665'] = ['ML detection failing to come back - central notify delayed','<b>W18:</b> Priority case, return code is &quot;Internal Error Occurred&quot;, very unspecific - many places this can be thrown from. Located source files but not project, allowing debug up to last function in PML before delete process begins. Identified which call the INTERNAL_ERROR comes from, on the 74th iteration of a decompression loop, a zlib function inflate() which returns BUF_ERROR - buffer not full or overfull. All returns except OK and END_STREAM result in INTERNAL ERROR being thrown here, which is fatal.<br><br>bp safestore64!decryptAndDecompressFile+0x3a7 &quot;j poi(fsize)&lt;0x2cdb694; &#39;gc&#39; &quot;<br>: Conditional breakpoint before function call to break before iteration where error occurs (fsize=0x2cc694) - otherwise continue (gc)<br><br>found inflate source, created D: drive, investigation continues.<br><br><b>W19:</b> Cx provided example file for testing, and issue is reproducible not just on Server 2012 but Win10 RS2 as well. Ticket mentioned pyInstaller package, so create executable from SuperOX py script, which is flagged as malware by ML but also restores successfully. Debugging compression process now on Win10.<br><br><b>W21:</b> Went to speak to Stephen Wassell who informed that Budapest is responsible for this functionality. Emailed Bal??zs Zsiga who concurred there is an issue with the handling of the error, and suggested I raise a CPISSUE. Also, recommended to try setting the return value in the debugger (Learnt how to do that), altered the error code to not be INTERNAL_ERROR, and when resumed the file restores successfully. ','New Bug']
CaseInfo['16666'] = ['Tesco unable to print','<b>W17:</b> Tesco software (winXP) is unable to create a BMP file for printing labels. If the file exists it can modify, and if SAVservice is disabled it can create. Exclusions are ineffective. Process Monitor running allows the file to be created successfully (filter driver issue?)<br><br><b>W18:</b> Disabled all Sophos functionality and recreated with procmon, managed to get an error code - 0xc000005a STATUS_INVALID_OWNER meaning the process cannot set the desired file owner. Same error message as a pop up when copying files into the folder. Noticed that D:\Program Files\  and subdirectories belong to an unresolved domain account, and setting to local admin resolves the issue. As yet unclear what the filter driver is doing to cause the file to be saved with this account as the owner, as when it works the local admin owns the .bmp file.<br><br><b>W19:</b> Used ApiMonitor to inspect NTCreateFile call - seems identical except one fails, but security  descriptor is NULL - default. <br><br><b>W22:</b> Still attempting to debug but the embedded OS is so far unsuccessful. Installed Windows XP of the same version, and POSReady7 next version to attempt to replicate. On all 3: Created new drive, created new admin, created new folder as admin and deleted account (owner is unresolved SID), then created file in folder. Cx OS failed as normal, and both others were successful indicating OS is likely significant. Unable to uninstall from Cx VM, or get clean POSReady2009 install so can&#39;t rule out other software, but no filter drivers on Cx VM other than SR.<br><br><b>W27:</b> Product Management agreed the defect is not going to be fixed. ','Environment Issue']
CaseInfo['16734'] = ['ESH Crash','<b>W19:</b> Seems from inital stack compared to source that the issue is a previous windows update is stored without a date, so when sorted on date an access violation is thrown. Subsequent dump stacks do not support this however, and cx reports that disabling the Windows Update service (which should cause the previous update enumeration to be skipped) does not rectify the issue. Cx recreated user profile and this resolved. ','Environment Issue']
CaseInfo['16765'] = ['Options not re-enabled after override','<b>W20:</b> Repro steps provided by L3 turned out to be for similar behaviour to cx reported issue that is not unexpected. Cx logs show AppC, DatC and Internet scanning never report true, despite receiving new policy. Can repro the UI behaviour, where these functionalities do slide back to on automatically, but after policy the functionality is as expected. The slider becomes expected after tabbing to a different page and back. SAV adapter settings do not update live however<br><br><b>W22:</b> Confirmed with cx that issue is confined to the UI and the functionality is still there, therefore downgraded ticket from critical to major. Still unable to repro, but investigated source of status - McsAgent &lt;- SAVAdapter via AdapterCrossTalk interface. Unsure if able to reproduce, there does seem to be some behaviour where SAV adaptor sliders do not refresh live, but on my machine as soon as policy arrives  and the tab is refreshed the sliders return.<br><br><b>W23:</b> Confirmed with Trace logs that some adaptor properties do report false after receiving policy, but MCSAgent trace does not log inside the SAV adapter, this requires a debug version. Lots of digging through source trying to identify where the value comes from. It seems multiple adaptor dlls are involved so unlikely that the settings not enabled are truly random.','Unresolved']
CaseInfo['16828'] = ['Certain Exchange 2016 autoExclusion','<b>W19:</b> found old proposal ticket, emailed Nick Barefoot (reporter) who confirmed the work is indefinitely paused. Linked KBA recommending exclusions though. ','Expected']
CaseInfo['16842'] = ['PPT saving slowly Win10 v. Win7','<b>W19:</b> May be clone of issue solved in engine 2.1.4. Requested ETL trace and repro file if upgrade does not solve.<br><br><b>W20:</b> cx uploaded files along with fresh logs. Confirmed onPrem with engine 3.73 SAVservice is scanning for over a minute, Central with engine 3.74 has no significant delay. File does also contain emf data which is mentioned in the initial issue ticket. Requested cx to check veex.dll version, and retest once upgraded, as release is between Nov 20th &amp; Dec 4th. ','Known Bug']
CaseInfo['16852'] = ['Some DLP events not reported','<b>W20:</b> Initial analysis was Destination Only scans were not being reported, as all events in &quot;broken&quot; computer were DO, however cx reports they are aware of this limitation, and performing the same test (copy file from desktop to USB with explorer) is reported differently on different machines. Logs do not support this, so requested more with verbose SAV and PML. ','Unresolved']
CaseInfo['16857'] = ['ESH UC not showing status correctly','<b>W20:</b> Exists old ticket where UC logs rotate so last status can&#39;t be found, but this has been fixed and status is now in xml file. Cx&#39;s xml is present and correct, and even if it wasn&#39;t there ESH would fall back to logs which contain a success event as most recent. Error case seems to be that file exists but ESH can&#39;t retrieve the data from it for some reason? Requested PML/fresh sdu of ESH refresh.<br><br><b>W21:</b> Logs obtained, status still good in current.xml file and in logs, but PML shows access denied. Seems UpdateCache and MessageRelay folders don&#39;t have User group read permission when installed, so assume the cx is running ESH on a non-admin account? There already exists a KBA stating that ESH must be run as admin. Issue resolved by correcting permissions on UpdateCache/MessageRelay folders. ','Environment Issue']
CaseInfo['16859'] = ['Install fails S1 with proxy','<b>W26:</b> same setup on other machines doesn&#39;t fail. On this one, proxy is system on others it isn&#39;t. Setup scenario and doesn&#39;t inherently fail. Will try to recreate situation with powershell.<br><br><b>W27:</b> built exe to replicate WinHTTP process just for fun. Used Message Analyser on the etl trace from netsh instead of perfmon, logging is pretty detailed. The WinHttp section of a working log is the same, however normally the WebIO api is used next and it is absent from the cx&#39;s log. WinHttp is is statically linked to WebIO. MUI is related to translation, so installed on DE machine to see which are used. Only &quot;winnlsres.dll&quot;. Removing all permissions on this file gives same errors as for cx.<br><br><b>W32:</b> Cx provided PML of install, target machine is actually a 2012RS2 server which requires C:\Windows\SysWOW64\en-US\KERNELBASE.dll.mui and is not found on CX server. Taking ownership and renaming this file causes the same error as Customer, and running sfc \scannow copies backup from C:\Windows\System32\en-US and resolves. Proxy confirmed not related. ','Environment Issue']
CaseInfo['16879'] = ['SSP StandAlone Install fail','<b>W20:</b> installer cannot read existing registry key, access denied. Same for user trying to delete as admin. PML doesn&#39;t seem to capture issue, but does show other AV &#39;bytefence&#39; running, requested to try without and gather PML.','Unresolved']
CaseInfo['16988'] = ['Delay saving Office docs to NAS','<b>W21:</b> Initally suspected oplocks like previous case, but SMB traffic is not SMB2, so not supported. PML and Wireshark don&#39;t line up, but suspicious of apparent 40s hang on close file, and found similar looking hang in wireshark, waiting for AndX Request response. Cx originally said 10-60s delay, so requested Wireshark &amp; PML of delay and not-delayed replication.<br><br><b>W32:</b> Temporary file close is held up by file size query for copy detection, almost certainly a timeout as 40s is very consistent. Same operation later on Book1.xlsx does not hang. New Wireshark still doesn&#39;t line up with the procmon, but attempting analysis anyway. Cx says the issue only occurs for this NAS not for any remote share, and protocol is SMB1 might be significant? Repro is unlikely. Registry key from 17886 that disables copy detection check might be useful to them tho. ','Unresolved']
CaseInfo['16995'] = ['Safestore config','<b>W21:</b> Cx wanted to change safestore limit so files over 50mb are not deleted. Functionality exists in API but not available for cx, clean to add reg keys and allow this config. ','Feature Request']
CaseInfo['17157'] = ['DLP working for admin but not user','<b>W22:</b> from PML the user account has folder redirection enabled, so the file is actually being transferred from a remote share. The cx has remote files disabled for on-access in Threat-Protection policy, which when tested also applies to DLP, so copying straight from remote share to browser does not flag if local only is selected. Asked Cx to test. ','Environment Issue']
CaseInfo['17232'] = ['DevC 20% CPU Usage','<b>W23:</b> Cx has 200+ Drives connected to NAS, controlled by disk organisation software, and every time QueryDevicePolicy() is called for a certain device the whole list is enumerated to find the ID of the one requested, which takes a lot of time. I created 15 virtual hard drives for a similar machine, and could create exactly the same logs with all the same &quot;errors&quot; in expected use. The enumeration of drives to get the ID does take 1-2 seconds every time for them, and this probably the cause of the slowdown. ','Environment Issue']
CaseInfo['17279'] = ['3rd Party SW unresponsive with sophos','<b>W24:</b> Component isolation unclear, only complete uninstall works. dump/PML shows HMPA and Detours dll still loaded so asked to try unloading.<br><br><b>W26:</b> Sage paperless remains hanging even after appInitDlls are disabled, and no sophos is loaded in dump. In house repro is likely not possible, so probably will have remote access.<br><br><b>W30:</b> Resolved for Cx with update to Sage 3rd part software. ','Environment Issue']
CaseInfo['17289'] = ['Admin signout when disabling settings with TP','<b>W23:</b> UI flicks back to home when disabling ML or OA with TP enabled. Logs show &quot;password is invalid&quot;, but further investigation is impossible as TP must be enabled and passwords are hidden in the logs. Attempting to build UI version where passwords are not hidden! Found build machine in buildcfg and used builder python script to meet dependencies. Also had to find a non-production version of MCS so it would accept non-release certificate, but after the logs show empty password field.<br><br><b>W24:</b> Debugging the release versions without tamper protection to see how far back the empty tokenFor Property comes from. Seems to still be empty at RequestHandler entry point. Seems as though after an adapter change to the CORE adaptor ClearAuthentication is called which calls authenticate with an empty password. This seems to be as result of an oversight, where clearing Authentication was required after a change to the SED adapter, then TP was moved to the CORE adapter but this logic was left in. Raised Bug ticket to fix.  ','New Bug']
CaseInfo['17319'] = ['Unitrends USB hang','<b>W24:</b> Software driver seems to cause explorer to hang when accessing a USB. Previous similar case resolved as cx upgraded and no longer required driver. Current cx apparently upgraded, and uninstall/reinstalled but still has driver. Only one machine seems to have installed the driver in house, server 2016 on Hyper-V. Unsure what logging we need to progress.<br><br><b>W27:</b> Managed to create Hyper-V setup inside windows 10 vm, and connect a physical USB. Installed Unitrends but no driver. Repeated with Server 2016 VM and delay is evident. In their logs function RetrieveBitmapOnInit hangs until sophos is disabled, the reports tracking not enabled.<br><br><b>W28:</b> Unitrends logs show hang from when device is first connected until SAVservice is disabled, then it can be accessed. tried taking a dump during hang, and enabling logging on the 3rd party driver - but nothing is clearer. Requested contact at Unitrends.<br><br><b>W31:</b> Customer has removed the driver causing the issue as it is only required for Hyper-V, but the issue still exists. No contact from Unitrends. ','Environment Issue']
CaseInfo['17344'] = ['Memory leak non-paged pool server 2012','<b>W24:</b> poolmon shows highest usage is for Sg01 pool tag - which is SophosED.sys . Looked into investigating leaks with Performance analyser, and found should be looking for AIFO (Alloc inside Free Outside) in ETL. Sg01 has none and HMPA frees more than it allocates in the duration of the trace, no significant increase is visible. Requested cx run typeperf command to trace pool sizes against time, to see when best time to gather another trace is. Update: Performance counter names translated on German Systems, wrote some powershell to run the command with translated values from the registry. UPDATE: had to add ability to persist a parameter through translation, e.g. \Process(system)\...<br><br><b>W27:</b> Translated typeperf command worked and cx managed to collect file. Trend is not consistently rising unfortunately, shows several small jumps that could be responsible. Requested repeats to see if there is a timing pattern and SDU to look for possible triggers.<br><br><b>W28:</b> cx provided more csvs and an ETL, but they are basically useless as they don&#39;t show any kind of growth. Asked them to do it again.<br><br><b>W29:</b> Latest Typeperfs do show trend up. Previous trace was irrelevant and falls into normal usage, new traces line up very well by time, seemingly stepping up every so often. Looked into scheduled tasks and can&#39;t see a smoking gun, but requested ETL at 10am day after reboot and a new SDU. Cx provided 10am WPA trace, seems to be in initial stage of the graph, before midnight when it begins to grow. Queried if cx rebooted recently<br><br><b>W30:</b> new trace shows HMPA pool at very high usage, and small increase (~5MB) with robocopy in the stack. Initial poolmon indicated Sg01 (SED) but usage was only 95MB rather than 3GB. Need a poolmon after longer to indite HMPA.','Unresolved']
CaseInfo['17374'] = ['Excel File slow save','<b>W24:</b> file in question has cells with data defined in another file. Created a test file and data file, where all data in test.xlsx comes from data.xlsx. data was ~3.5s to save regardless of Sophos state, test was ~7.5s with OA off and 11s with it on, so potentially there is an issue. SAV doesn&#39;t scan the referenced file when the host is saved however. In the cx&#39;s procmon SAV holds the file for ~25s before allowing excel to save it, in mine ~2s. On Access logs have a lot of &quot;QueryFileName: Call to GetFileNameInformation failed with status: 80000005.&quot; - as yet unsure if this is relevant','Unresolved']
CaseInfo['17382'] = ['Install with Kaseya fails 401','<b>W26:</b> Deployment via Kaseya fails as getDeploymentInfo() responds &quot;Access Denied&quot;. Traffic is encrypted TLS so cannot see request/response details in the wireshark. SophosSetup.exe allows parameters, and using cx&#39;s id and mgmt server URL I can reproduce the 401 error. 401 in this case can mean malformed JSON, or missing/invalid cx id. Swapping mgmt server for default fixes, so location is probably wrong. <br><br><b>W27:</b> Learnt that partner deployment provides &quot;blank&quot; installer so no preset arguments for install parameters - they have to be set. Having the cx run the installer without arguments is impossible. Most likely that management server from csv is wrong, however cx says it is correct from the CSV. The authentication is the same for both MCS servers, and it is unlikely that changing the server malforms the content, therefore have passed case to CESG.<br><br><b>W28:</b> To absolutely everyone&#39;s surprise the cx can&#39;t read and the server was wrong. ','Environment Issue']
CaseInfo['17442'] = ['SED64 upgrade fail','<b>W28:</b> Due to previous failed upgrade (failed to copy ELAMBACKUP Driver) and the rollback process from a failed upgrade not replacing the old integrity.dat, the exisiting SED has integrity for v2.0 but is actually v1.4. MCS tamper protection disable doesn&#39;t work, and no SEDcli on v1.4, but replacing v1.4 integrity.dat with v2.0 in safe mode will fix. Cx has a lot of endpoints tho and doesn&#39;t want to do this for every one. Turns out MCS isn&#39;t able to disable TP because the upgrade unregisters the CORE/CORC adapters and doesn&#39;t reinstate them on rollback. Upgrading to 2.1 does not resolve the issue but does fix so going v1.4 -&gt; v2.1 is ok. Cxs in broken state will have to use safe mode. ','Workaround']
CaseInfo['17557'] = ['Powerpoint hang when opening/saving','<b>W29:</b> Possibly related to fix in engine 3.74 as cx has seen &quot;improvement&quot;, but nothing definitive. They still have cryptoguard which would cause some delay backing up the file to a temp location. Since upgrading they haven&#39;t gathered any new verbose logs so we&#39;ll need those if there is an issue, and the etl trace seems to  have been gathered incorrectly. ','No Response']
CaseInfo['17584'] = ['PTP Devices not allowed by exclusion','<b>W28:</b> Seems to be excess &amp;amp; that doesn&#39;t get converted to the symbol, confirmed this on german VM using phone as PTP device. Looking at first detection event, and received policy it seems central is adding extra amp;s, as if the exclusion came down as it is sent up it would exclude correctly.<br><br><b>W29:</b> verified new cx as same issue for Asim. ','Transferred']
CaseInfo['17595'] = ['failed standalone install','<b>W28:</b> Logs and PML don&#39;t really match up - reaching different stages and exiting with different codes. Also have Win7 pml with no SDU. Requested matching log and pml from win10 and win7 machines.<br><br><b>W29:</b> During install a temporary file is created (successfully from the PML), then attempted to be opened with of:stream. The file is not created again in the PML and the error message indicated the open failed, despite the file existing. Created test exe to run suspect winapis on cx computer. Emile has taken over case. ','Transferred']
CaseInfo['17610'] = ['Chrome Crash with SLD','<b>W28:</b> Server does not need to be locked down, just installed, crash occurs around when RES dlls are loaded into process, and error code is 0xc0000135 - DLL not found. Requested reduced altitude PML of crash with and without server locked down. <br><br><b>W29:</b> New logs from cx. SLD driver is only injected if process is trusted? logs from cx seem to match when file is not trusted. When file is trusted logs look different on admin user, maybe this is why admin user is ok and normal user fails for cx? Process is untrusted as it is run as user, then why does the dll get loaded? Why do their dlls not get loaded when SLD is not installed? <br><br><b>W30:</b> passed back to Toby with Qs for Ivanti (3rd party dev). Experimented with SLD to see under what conditions a process is &quot;trusted&quot; and has SLD dlls injected.','Unresolved']
CaseInfo['17706'] = ['Hips blocking VMware profiles','<b>W29:</b> Have RSDebug log but PML is corrupted. Not much to be gather in the PML other than the reg keys are accessed. As HIPS is confirmed as the culprit transferred to labs. ','Transferred']
CaseInfo['17783'] = ['Mem leak opening and closing file','<b>W30:</b> Cx provided batch file to replicate but could not reproduce locally, cx stopped responding.','Unresolved']
CaseInfo['17886'] = ['Slow DLL copy','<b>W31:</b> determined that remote folder AV is not relevant, repeat copies after initial are at normal speed suggests caching issue. PML stack analysis suggests remote file copies are normally scanned locally and checksummed to identify, then the remote copy checksum matches so they do not need to be scanned again (at great cost). Cx PML shows remote checksum doesn&#39;t match for certain dlls, therefore file is scanned in remote location, seems to be because local scan does not generate a checksum. Default local checksum setting is &quot;auto&quot; can be set to &quot;on&quot; and seems to resolve the issue if the file is scanned locally. Cx PML shows local file is cached so recommended they clear cache as well.<br><br><b>W32:</b> Cx confirmed that enabling local checksumming dropped copy duration from 20 mins to 12 seconds (7 seconds pre-Sophos), however would like an explanation for &quot;70% performance hit&quot;. It is likely there is nothing more we can do, but asked for a new PML anyway.','Unresolved']
CaseInfo['17922'] = ['SD card reader explorer hang','<b>W32:</b> Explorer hangs when SD card is inserted into built in reader, when browsing contents or sometimes just browsing C (?) Running DISKPART alleviates. Cx confirmed issue is specific to a certain laptop model, which has unique driver to other similar models tested. SavOnAccess.sys seems at fault as unloading/stopping savservice alleviates.<br><br>Used WINDBG to inspect a force crash memory dump during the hang, and the SavOnAccess driver is in the stack of one of the explorer threads:<br>savonaccess!GetSectorSize+0x96  <br>savonaccess!IsDiskReadable+0xb3  <br>savonaccess!CheckDisk+0x3e <br>savonaccess!FileChecker::IsFloppyDisabled+0xac <br>savonaccess!FileChecker::PreCreateChecks+0x2fa <br>savonaccess!AntiVirusPreCreate+0x324 <br>savonaccess!PreCreate+0x54<br>Which needs investigating.<br><br><b>W33:</b> Read a lot about IRP and how it works with drivers, and looked into the stack from the dump. The driver is still waiting on a pending IRP request for IOCTL_DISK_GET_DRIVE_GEOMETRY as part of the boot sector check of the new drive. This IRP request comes back pending and seems to remain pending indefinitely until diskpart is able to free it somehow? In the explorer Thread there are 2 active IRPS:<br>one of which has current stack frame <br><br>[IRP_MJ_DEVICE_CONTROL(e), N/A(0)] <br>\Driver\Disk	volmgr!VmpRefCountCompletionRoutine		<br>Args: 00000018 00000000 0x70000 00000000<br>	<br>Arg 3 is IOCTL and !ioctldecode 0x70000 = IOCTL_DISK_GET_DRIVE_GEOMETRY    <br><br>So on the right lines. <br><br>Maria assisted on day 2 and suggested I look for other threads with the same Wait Start TickCount i.e. began waiting at the same time, as the stack for the thread I found had symbols for all the functions, so not 3rd party. Found a system thread with exactly the same wait start, and &quot;RtsPer&quot; in the stack - no symbols. This is &quot;RealTek RTS PCIE READER Driver&quot; the maker of the sd card reader. <br><br>Written a usermode process to create the same irp request for either a passed drive letter or for all drives. It seems to interfere with running VMs causing bluescreen/lack of OS and requiring image restore. Added a warning to this effect and a confirmation line allowing bail.','Unresolved']
CaseInfo['17965'] = ['Missing Exchange auto-exclusions','<b>W31:</b> detects exchange 2010 correctly but only 1 mailbox db out of 9 is auto excluded. Inspected lua this comes from and this info is from Get-MailboxDatabase ps command. Static debugging suggests the following operations do not account for this being a list of paths rather than a single path. <br>Set up a Domain Controller VM with Exchange server 2010 and confirmed the bug occurs with 2 mailboxes, then created a C executable to run a lua file (on Github). I wrote lua to run a powershell command to get Exchange config then interpret it in the same way as the Sophos code, but simplifying some parameters etc. and see the issue is as expected. Subsequent values overwrite the previous ones as they write to the same key. Modified the code to append to a list and handle the list correctly later on, then tested and submitted a CSRV ticket. ','Suggested Fix']
;
	  
		var data;
		var view;
	  
		function drawChart() 
		{		
			data = new google.visualization.DataTable();
			//powershell variable replaced by values
			data.addColumn({type:'string', role:'domain', label:'Week'});
data.addColumn({type:'number', role:'data', label:'00000'});
data.addColumn({type:'string', role:'tooltip', label:'00000T'});
data.addColumn({type:'number', role:'data', label:'00001'});
data.addColumn({type:'string', role:'tooltip', label:'00001T'});
data.addColumn({type:'number', role:'data', label:'12724'});
data.addColumn({type:'string', role:'tooltip', label:'12724T'});
data.addColumn({type:'number', role:'data', label:'13785'});
data.addColumn({type:'string', role:'tooltip', label:'13785T'});
data.addColumn({type:'number', role:'data', label:'13854'});
data.addColumn({type:'string', role:'tooltip', label:'13854T'});
data.addColumn({type:'number', role:'data', label:'14171'});
data.addColumn({type:'string', role:'tooltip', label:'14171T'});
data.addColumn({type:'number', role:'data', label:'14202'});
data.addColumn({type:'string', role:'tooltip', label:'14202T'});
data.addColumn({type:'number', role:'data', label:'14566'});
data.addColumn({type:'string', role:'tooltip', label:'14566T'});
data.addColumn({type:'number', role:'data', label:'14780'});
data.addColumn({type:'string', role:'tooltip', label:'14780T'});
data.addColumn({type:'number', role:'data', label:'14813'});
data.addColumn({type:'string', role:'tooltip', label:'14813T'});
data.addColumn({type:'number', role:'data', label:'14870'});
data.addColumn({type:'string', role:'tooltip', label:'14870T'});
data.addColumn({type:'number', role:'data', label:'14952'});
data.addColumn({type:'string', role:'tooltip', label:'14952T'});
data.addColumn({type:'number', role:'data', label:'14996'});
data.addColumn({type:'string', role:'tooltip', label:'14996T'});
data.addColumn({type:'number', role:'data', label:'15037'});
data.addColumn({type:'string', role:'tooltip', label:'15037T'});
data.addColumn({type:'number', role:'data', label:'15302'});
data.addColumn({type:'string', role:'tooltip', label:'15302T'});
data.addColumn({type:'number', role:'data', label:'15413'});
data.addColumn({type:'string', role:'tooltip', label:'15413T'});
data.addColumn({type:'number', role:'data', label:'15452'});
data.addColumn({type:'string', role:'tooltip', label:'15452T'});
data.addColumn({type:'number', role:'data', label:'15532'});
data.addColumn({type:'string', role:'tooltip', label:'15532T'});
data.addColumn({type:'number', role:'data', label:'15616'});
data.addColumn({type:'string', role:'tooltip', label:'15616T'});
data.addColumn({type:'number', role:'data', label:'15728'});
data.addColumn({type:'string', role:'tooltip', label:'15728T'});
data.addColumn({type:'number', role:'data', label:'16251'});
data.addColumn({type:'string', role:'tooltip', label:'16251T'});
data.addColumn({type:'number', role:'data', label:'16337'});
data.addColumn({type:'string', role:'tooltip', label:'16337T'});
data.addColumn({type:'number', role:'data', label:'16385'});
data.addColumn({type:'string', role:'tooltip', label:'16385T'});
data.addColumn({type:'number', role:'data', label:'16477'});
data.addColumn({type:'string', role:'tooltip', label:'16477T'});
data.addColumn({type:'number', role:'data', label:'16527'});
data.addColumn({type:'string', role:'tooltip', label:'16527T'});
data.addColumn({type:'number', role:'data', label:'16554'});
data.addColumn({type:'string', role:'tooltip', label:'16554T'});
data.addColumn({type:'number', role:'data', label:'16598'});
data.addColumn({type:'string', role:'tooltip', label:'16598T'});
data.addColumn({type:'number', role:'data', label:'16624'});
data.addColumn({type:'string', role:'tooltip', label:'16624T'});
data.addColumn({type:'number', role:'data', label:'16665'});
data.addColumn({type:'string', role:'tooltip', label:'16665T'});
data.addColumn({type:'number', role:'data', label:'16666'});
data.addColumn({type:'string', role:'tooltip', label:'16666T'});
data.addColumn({type:'number', role:'data', label:'16734'});
data.addColumn({type:'string', role:'tooltip', label:'16734T'});
data.addColumn({type:'number', role:'data', label:'16765'});
data.addColumn({type:'string', role:'tooltip', label:'16765T'});
data.addColumn({type:'number', role:'data', label:'16828'});
data.addColumn({type:'string', role:'tooltip', label:'16828T'});
data.addColumn({type:'number', role:'data', label:'16842'});
data.addColumn({type:'string', role:'tooltip', label:'16842T'});
data.addColumn({type:'number', role:'data', label:'16852'});
data.addColumn({type:'string', role:'tooltip', label:'16852T'});
data.addColumn({type:'number', role:'data', label:'16857'});
data.addColumn({type:'string', role:'tooltip', label:'16857T'});
data.addColumn({type:'number', role:'data', label:'16859'});
data.addColumn({type:'string', role:'tooltip', label:'16859T'});
data.addColumn({type:'number', role:'data', label:'16879'});
data.addColumn({type:'string', role:'tooltip', label:'16879T'});
data.addColumn({type:'number', role:'data', label:'16988'});
data.addColumn({type:'string', role:'tooltip', label:'16988T'});
data.addColumn({type:'number', role:'data', label:'16995'});
data.addColumn({type:'string', role:'tooltip', label:'16995T'});
data.addColumn({type:'number', role:'data', label:'17157'});
data.addColumn({type:'string', role:'tooltip', label:'17157T'});
data.addColumn({type:'number', role:'data', label:'17232'});
data.addColumn({type:'string', role:'tooltip', label:'17232T'});
data.addColumn({type:'number', role:'data', label:'17279'});
data.addColumn({type:'string', role:'tooltip', label:'17279T'});
data.addColumn({type:'number', role:'data', label:'17289'});
data.addColumn({type:'string', role:'tooltip', label:'17289T'});
data.addColumn({type:'number', role:'data', label:'17319'});
data.addColumn({type:'string', role:'tooltip', label:'17319T'});
data.addColumn({type:'number', role:'data', label:'17344'});
data.addColumn({type:'string', role:'tooltip', label:'17344T'});
data.addColumn({type:'number', role:'data', label:'17374'});
data.addColumn({type:'string', role:'tooltip', label:'17374T'});
data.addColumn({type:'number', role:'data', label:'17382'});
data.addColumn({type:'string', role:'tooltip', label:'17382T'});
data.addColumn({type:'number', role:'data', label:'17442'});
data.addColumn({type:'string', role:'tooltip', label:'17442T'});
data.addColumn({type:'number', role:'data', label:'17557'});
data.addColumn({type:'string', role:'tooltip', label:'17557T'});
data.addColumn({type:'number', role:'data', label:'17584'});
data.addColumn({type:'string', role:'tooltip', label:'17584T'});
data.addColumn({type:'number', role:'data', label:'17595'});
data.addColumn({type:'string', role:'tooltip', label:'17595T'});
data.addColumn({type:'number', role:'data', label:'17610'});
data.addColumn({type:'string', role:'tooltip', label:'17610T'});
data.addColumn({type:'number', role:'data', label:'17706'});
data.addColumn({type:'string', role:'tooltip', label:'17706T'});
data.addColumn({type:'number', role:'data', label:'17783'});
data.addColumn({type:'string', role:'tooltip', label:'17783T'});
data.addColumn({type:'number', role:'data', label:'17886'});
data.addColumn({type:'string', role:'tooltip', label:'17886T'});
data.addColumn({type:'number', role:'data', label:'17922'});
data.addColumn({type:'string', role:'tooltip', label:'17922T'});
data.addColumn({type:'number', role:'data', label:'17965'});
data.addColumn({type:'string', role:'tooltip', label:'17965T'});
data. addRows([
['0',null,'',null,'',null,'',null,'',0,'13854: Wifi adapter device instance ID script',null,'',null,'',null,'',0,'14780: Edge failing to access intranet sites',0,'14813: Timed Web Controls not taking effect',0,'14870: Build times increased',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['1',null,'',null,'',null,'',null,'',1,'13854: Wifi adapter device instance ID script',null,'',null,'',0,'14566: Spreadsheets flagged as &quot;Script/Markup&quot;',1,'14780: Edge failing to access intranet sites',1,'14813: Timed Web Controls not taking effect',1,'14870: Build times increased',0,'14952: IE hanging on some downloads',null,'',0,'15037: SAV install failing on Custom action',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['2',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'14566: Spreadsheets flagged as &quot;Script/Markup&quot;',null,'',null,'',null,'',1,'14952: IE hanging on some downloads',0,'14996: Lack of USB Block Notifications',1,'15037: SAV install failing on Custom action',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['3',null,'',null,'',null,'',0,'13785: Only one confirmation dialogue with attaching files to email for ~3s',null,'',0,'14171: SSPService crashing infrequently',0,'14202: Multiple Emails from single Virus detections',null,'',null,'',null,'',null,'',null,'',1,'14996: Lack of USB Block Notifications',2,'15037: SAV install failing on Custom action',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['4',0,'00000: Health Trails Tool',null,'',null,'',1,'13785: Only one confirmation dialogue with attaching files to email for ~3s',null,'',1,'14171: SSPService crashing infrequently',1,'14202: Multiple Emails from single Virus detections',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['5',1,'00000: Health Trails Tool',null,'',null,'',null,'',null,'',2,'14171: SSPService crashing infrequently',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',0,'15452: Winsock catalog unexpected update',0,'15532: productState possible values',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['6',2,'00000: Health Trails Tool',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',0,'15302: 2 USB sticks not blocked by DevC',null,'',1,'15452: Winsock catalog unexpected update',1,'15532: productState possible values',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['7',3,'00000: Health Trails Tool',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'15302: 2 USB sticks not blocked by DevC',0,'15413: Winsock catalog unexpected update',2,'15452: Winsock catalog unexpected update',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['8',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',2,'15302: 2 USB sticks not blocked by DevC',1,'15413: Winsock catalog unexpected update',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['9',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['10',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['11',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',3,'15302: 2 USB sticks not blocked by DevC',2,'15413: Winsock catalog unexpected update',3,'15452: Winsock catalog unexpected update',2,'15532: productState possible values',null,'',0,'15728: Unexpected DatC alert from NTFS FileStream',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['12',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',3,'15532: productState possible values',null,'',1,'15728: Unexpected DatC alert from NTFS FileStream',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['13',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',4,'15302: 2 USB sticks not blocked by DevC',null,'',null,'',null,'',0,'15616: Live Protection stopping fax service',2,'15728: Unexpected DatC alert from NTFS FileStream',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['14',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',5,'15302: 2 USB sticks not blocked by DevC',null,'',null,'',null,'',1,'15616: Live Protection stopping fax service',3,'15728: Unexpected DatC alert from NTFS FileStream',null,'',null,'',0,'16385: PUA not restored with Dell Encryption',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['15',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',2,'15616: Live Protection stopping fax service',4,'15728: Unexpected DatC alert from NTFS FileStream',null,'',null,'',1,'16385: PUA not restored with Dell Encryption',null,'',0,'16527: Japanese new Error Message',0,'16554: Clean High Disk IO',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['16',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',3,'15616: Live Protection stopping fax service',null,'',null,'',0,'16337: Slow xls file folder copy to server',2,'16385: PUA not restored with Dell Encryption',0,'16477: Japanese Server 2012 installer text garbled',1,'16527: Japanese new Error Message',1,'16554: Clean High Disk IO',0,'16598: MTD causes VOIP to drop calls',null,'',null,'',0,'16666: Tesco unable to print',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['17',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'16337: Slow xls file folder copy to server',3,'16385: PUA not restored with Dell Encryption',1,'16477: Japanese Server 2012 installer text garbled',2,'16527: Japanese new Error Message',null,'',1,'16598: MTD causes VOIP to drop calls',0,'16624: 2GB+ upload fails on sendthisfile.com',0,'16665: ML detection failing to come back - central notify delayed',1,'16666: Tesco unable to print',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['18',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'16624: 2GB+ upload fails on sendthisfile.com',1,'16665: ML detection failing to come back - central notify delayed',2,'16666: Tesco unable to print',0,'16734: ESH Crash',null,'',0,'16828: Certain Exchange 2016 autoExclusion',0,'16842: PPT saving slowly Win10 v. Win7',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['19',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',4,'16385: PUA not restored with Dell Encryption',null,'',null,'',null,'',2,'16598: MTD causes VOIP to drop calls',null,'',2,'16665: ML detection failing to come back - central notify delayed',3,'16666: Tesco unable to print',1,'16734: ESH Crash',0,'16765: Options not re-enabled after override',1,'16828: Certain Exchange 2016 autoExclusion',1,'16842: PPT saving slowly Win10 v. Win7',0,'16852: Some DLP events not reported',0,'16857: ESH UC not showing status correctly',null,'',0,'16879: SSP StandAlone Install fail',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['20',null,'',null,'',0,'12724: Detection of &#39;both&#39; location takes 5 minutes',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',3,'16598: MTD causes VOIP to drop calls',null,'',null,'',null,'',null,'',1,'16765: Options not re-enabled after override',null,'',2,'16842: PPT saving slowly Win10 v. Win7',1,'16852: Some DLP events not reported',1,'16857: ESH UC not showing status correctly',null,'',1,'16879: SSP StandAlone Install fail',0,'16988: Delay saving Office docs to NAS',0,'16995: Safestore config',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['21',null,'',null,'',1,'12724: Detection of &#39;both&#39; location takes 5 minutes',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',3,'16665: ML detection failing to come back - central notify delayed',null,'',null,'',null,'',null,'',null,'',null,'',2,'16857: ESH UC not showing status correctly',null,'',null,'',1,'16988: Delay saving Office docs to NAS',1,'16995: Safestore config',0,'17157: DLP working for admin but not user',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['22',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',4,'16666: Tesco unable to print',null,'',2,'16765: Options not re-enabled after override',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'17157: DLP working for admin but not user',0,'17232: DevC 20% CPU Usage',null,'',0,'17289: Admin signout when disabling settings with TP',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['23',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',3,'16765: Options not re-enabled after override',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'17232: DevC 20% CPU Usage',0,'17279: 3rd Party SW unresponsive with sophos',1,'17289: Admin signout when disabling settings with TP',0,'17319: Unitrends USB hang',0,'17344: Memory leak non-paged pool server 2012',0,'17374: Excel File slow save',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['24',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'17279: 3rd Party SW unresponsive with sophos',2,'17289: Admin signout when disabling settings with TP',1,'17319: Unitrends USB hang',1,'17344: Memory leak non-paged pool server 2012',1,'17374: Excel File slow save',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['25',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',0,'16859: Install fails S1 with proxy',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',0,'17382: Install with Kaseya fails 401',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['26',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'16859: Install fails S1 with proxy',null,'',null,'',null,'',null,'',null,'',2,'17279: 3rd Party SW unresponsive with sophos',null,'',null,'',null,'',null,'',1,'17382: Install with Kaseya fails 401',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['27',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',5,'16666: Tesco unable to print',null,'',null,'',null,'',null,'',null,'',null,'',2,'16859: Install fails S1 with proxy',null,'',null,'',null,'',null,'',null,'',null,'',null,'',2,'17319: Unitrends USB hang',2,'17344: Memory leak non-paged pool server 2012',null,'',2,'17382: Install with Kaseya fails 401',0,'17442: SED64 upgrade fail',null,'',0,'17584: PTP Devices not allowed by exclusion',0,'17595: failed standalone install',0,'17610: Chrome Crash with SLD',null,'',null,'',null,'',null,'',null,''],
['28',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',0,'16251: Slow first boot non-persistent VDIs',null,'',null,'',null,'',null,'',null,'',null,'',2,'16624: 2GB+ upload fails on sendthisfile.com',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',3,'17319: Unitrends USB hang',3,'17344: Memory leak non-paged pool server 2012',null,'',3,'17382: Install with Kaseya fails 401',1,'17442: SED64 upgrade fail',0,'17557: Powerpoint hang when opening/saving',1,'17584: PTP Devices not allowed by exclusion',1,'17595: failed standalone install',1,'17610: Chrome Crash with SLD',0,'17706: Hips blocking VMware profiles',null,'',null,'',null,'',null,''],
['29',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'16251: Slow first boot non-persistent VDIs',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',4,'17344: Memory leak non-paged pool server 2012',null,'',null,'',null,'',1,'17557: Powerpoint hang when opening/saving',2,'17584: PTP Devices not allowed by exclusion',2,'17595: failed standalone install',2,'17610: Chrome Crash with SLD',1,'17706: Hips blocking VMware profiles',0,'17783: Mem leak opening and closing file',null,'',null,'',null,''],
['30',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',3,'17279: 3rd Party SW unresponsive with sophos',null,'',null,'',5,'17344: Memory leak non-paged pool server 2012',null,'',null,'',null,'',null,'',null,'',null,'',3,'17610: Chrome Crash with SLD',null,'',1,'17783: Mem leak opening and closing file',0,'17886: Slow DLL copy',null,'',0,'17965: Missing Exchange auto-exclusions'],
['31',null,'',0,'00001: Case Grapher',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',2,'16337: Slow xls file folder copy to server',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',4,'17319: Unitrends USB hang',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',1,'17886: Slow DLL copy',0,'17922: SD card reader explorer hang',1,'17965: Missing Exchange auto-exclusions'],
['32',null,'',1,'00001: Case Grapher',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',3,'16859: Install fails S1 with proxy',null,'',2,'16988: Delay saving Office docs to NAS',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',2,'17886: Slow DLL copy',1,'17922: SD card reader explorer hang',null,''],
['33',null,'',2,'00001: Case Grapher',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',2,'17922: SD card reader explorer hang',null,''],
['34',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['35',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['36',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['37',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['38',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['39',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['40',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['41',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['42',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['43',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['44',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['45',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['46',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['47',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['48',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['49',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['50',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],
['51',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,'',null,''],]);
			
			//Graph options
			var opts = {
				title: 'Case Worklog',
				interpolateNulls: true,
				height: 600,
				pointsVisible: true,
				legend: 
				{ 
					position: 'top',
					maxLines: 10
				},
				hAxis: 
				{ 
					title: 'Week Number',
					showTextEvery: 1,
					allowContainerBoundaryTextCufoff: false
				},
				vAxis: 
				{ 
					title: 'Weeks spent on Case'
				},
				tooltip:
				{
					isHtml: true,
				}
			};
			
			//Define chart type with wrapper
			wrapper = new google.visualization.ChartWrapper(
			{	
				chartType: 'LineChart',
				dataTable: data,
				options: opts,
				containerId: 'vis',
			});
			
			//Once ready event is fired the onReady function is called
			google.visualization.events.addListener(wrapper, 'ready', onReady);
			
			//Chart must always have a view for CaseLog functionality when filtered
			view = new google.visualization.DataView(data);
			wrapper.setView(view.toJSON());
			
			//Draw to html div with ID curve_chart
			wrapper.draw(document.getElementById('curve_chart'));
		}
		
		//onSelect Listener can only be added once ready
		function onReady()
		{
			google.visualization.events.addListener(wrapper, 'select', onSelect);
		}
		
		//Show CaseLog in div below. This is non-trivial as multiple cases might have a point behind the one clicked,
		//but getSelection only returns the top one
		function onSelect()
		{		
			selection = wrapper.getChart().getSelection();
			
			row = selection[0].row;
			
			//This must be the view rather than the DataTable as otherwise the column will likely be wrong
			val = view.getValue(row, selection[0].column);
			
			//loop limit
			limit = view.getNumberOfColumns();
			
			document.getElementById("CaseLog").innerHTML = "<p>";
			
			//If value in this row (week) is the same for another column(case) they share this point on the graph
			for (i = 1; i < limit; i+=2)
			{
				console.log(view.getValue(row, i))
				if (val == view.getValue(row, i))
				{
					caseNumber = view.getColumnLabel(i);
					try
					{
						document.getElementById("CaseLog").innerHTML += "<b>" + caseNumber + ": " + CaseInfo[caseNumber][0] +"</b><br>" + CaseInfo[caseNumber][1] + "<br></p>";
					}
					catch(err) {} //Sometimes tries to read from tooltip columns, not sure why
					}
			}
		}
		
		//If case has passed result, push case number and case number tooltip to list of included columns
		function listFromResolution(result)
		{
			var list = [0];
			for (var key in CaseInfo)
			{
				if (CaseInfo[key][2] == result)
				{
					list.push(key);
					list.push(key+'T');
				}
			}
			return list;
		}
		
		//Passed a string to find the columns for
		function getFilter(result)
		{
			filterGraph(listFromResolution(result));
		}
		
		//Re-Draw graph with only given columns
		function filterGraph(columns)
		{
			view = new google.visualization.DataView(data);
			view.setColumns(columns);
			wrapper.setView(view.toJSON());
			
			wrapper.draw(document.getElementById('curve_chart'));
		}
		
		//Re-Draw graph with no filter
		function showAll()
		{
			view = new google.visualization.DataView(data);
			wrapper.setView(view.toJSON());
			
			wrapper.draw(document.getElementById('curve_chart'));
		}
	</script>
	<style>
		#CaseLog 
		{
			display: inline-block;
			width: 50vw;
			text-align: left;
		}
		.container
		{
			text-align: center;
		}
	</style>
  </head>
  <body>
    <div id="curve_chart"></div>
	<div class="container">
		<div id="controls">
			<button onclick="showAll()" id="filterButton1">ALL</button>
			<button onclick="getFilter(this.innerHTML)">Suggested Fix</button>
			<button onclick="getFilter(this.innerHTML)">New Bug</button>
			<button onclick="getFilter(this.innerHTML)">Known Bug</button>
			<button onclick="getFilter(this.innerHTML)">Environment Issue</button>
			<button onclick="getFilter(this.innerHTML)">Feature Request</button>
			<button onclick="getFilter(this.innerHTML)">Expected</button>
			<button onclick="getFilter(this.innerHTML)">Workaround</button>
			<button onclick="getFilter(this.innerHTML)">Transferred</button>
			<button onclick="getFilter(this.innerHTML)">No Response</button>
			<button onclick="getFilter(this.innerHTML)">Unresolved</button>
		</div>
		<div id="CaseLog"></div>
	</div>
  </body>
</html>

